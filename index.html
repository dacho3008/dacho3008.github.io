<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="BERGHEIM TOTAL: Deutschlandweite Plattform f√ºr Services, Kultur, Religion, Jobs, Vermisste, Schwarzes Brett ‚Äì kostenlos f√ºr Vereine! Skalierbar bis 2030. DSGVO-konform.">
  <meta name="keywords" content="Bergheim, NRW, Deutschland, Notdienste, Vermisste, Museen, Kirchen, Moscheen, Jobs, Events, Unternehmen, Beh√∂rden, Gerichte, Schwarzes Brett, Inklusion, Barrierefrei">
  <meta name="author" content="Joshua Blum, BERGHEIM TOTAL, Alle Rechte vorbehalten">
  <title>BERGHEIM TOTAL üëë ‚Äì Von Bergheim zu Deutschland</title>
  <link rel="manifest" href="/manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.338/pdf.min.js"></script>
  <style>
    body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background: #f4f4f4; color: #333; overflow-x: hidden; }
    header { background: #007bff; color: white; text-align: center; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
    nav a { color: white; margin: 0 12px; text-decoration: none; font-weight: bold; transition: color 0.3s; cursor: pointer; }
    nav a:hover { color: #ffeb3b; }
    .container { max-width: 1200px; margin: auto; padding: 20px; }
    .section { border: 1px solid #ddd; padding: 15px; margin: 10px 0; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: transform 0.2s; }
    .section:hover { transform: scale(1.02); }
    .section img { max-width: 100%; border-radius: 8px; margin-top: 10px; }
    .priority { background: #ffeb3b; border-left: 5px solid #ffc107; }
    .search-bar { width: 100%; padding: 12px; font-size: 16px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }
    .filter-btn { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; border-radius: 4px; transition: background 0.3s; }
    .filter-btn:hover { background: #0056b3; }
    footer { background: #007bff; color: white; text-align: center; padding: 15px; margin-top: 30px; border-top: 3px solid #ffeb3b; }
    .cta-button { background: #28a745; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; display: inline-block; margin-top: 10px; transition: background 0.3s; }
    .cta-button:hover { background: #218838; }
    .category-header { font-size: 1.5em; color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 10px; margin-bottom: 20px; }
    .grid-categories { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
    .grid-button { background: #ffffff; border: 1px solid #ddd; padding: 20px; text-align: center; border-radius: 8px; cursor: pointer; transition: background 0.3s, transform 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .grid-button:hover { background: #e9ecef; transform: scale(1.05); }
    .grid-button h3 { margin: 10px 0; color: #007bff; }
    .grid-button p { font-size: 0.9em; color: #666; }
    .hidden { display: none; }
    #login-section, #social-media-section, #blackboard-section, #profile-section { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
    #blackboard-posts { margin-top: 20px; }
    #blackboard-form, #social-media-form, #profile-form { display: flex; flex-direction: column; gap: 10px; }
    #blackboard-form input, #blackboard-form textarea, #social-media-form input, #social-media-form textarea, #profile-form input { padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
    #blackboard-form button, #social-media-form button, #profile-form button { background: #28a745; color: white; padding: 10px; border: none; border-radius: 4px; cursor: pointer; }
    #blackboard-form button:hover, #social-media-form button:hover, #profile-form button:hover { background: #218838; }
    #location-status { margin-top: 10px; font-style: italic; }
    #pdf-viewer { height: 400px; border: 1px solid #ddd; margin-top: 10px; }
    @media (max-width: 600px) { .section { font-size: 14px; } .filter-btn { width: 100%; } .grid-categories { grid-template-columns: 1fr; } }
    a { color: #007bff; text-decoration: underline; }
    button:focus, input:focus, select:focus { outline: 2px solid #007bff; }
    #cookie-banner { position: fixed; bottom: 0; background: #fff; padding: 10px; width: 100%; border-top: 1px solid #ddd; display: none; box-shadow: 0 -2px 4px rgba(0,0,0,0.1); z-index: 1000; }
    .copyright { font-size: 0.8em; color: #888; text-align: center; margin-top: 20px; }
  </style>
</head>
<body>
  <header role="banner">
    <h1>BERGHEIM TOTAL üëë ‚Äì Von Bergheim zu Deutschland!</h1>
    <p>Verbinde ALLE: Services, Kultur, Religion, Jobs, Soziale Projekte, Schwarzes Brett ‚Äì kostenlos f√ºr Vereine! 2030-ready! DSGVO-konform.</p>
    <nav aria-label="Hauptmen√º">
      <a onclick="showSection('region')">Region</a>
      <a onclick="showSection('notdienste')">Notdienste</a>
      <a onclick="showSection('vermisste')">Vermisste</a>
      <a onclick="showSection('kultur-religion')">Kultur & Religion</a>
      <a onclick="showSection('jobs-events')">Jobs & Events</a>
      <a onclick="showSection('unternehmen')">Unternehmen</a>
      <a onclick="showSection('behoerden-gerichte')">Beh√∂rden & Gerichte</a>
      <a onclick="showSection('services')">Andere Services</a>
      <a onclick="showSection('blackboard')">Schwarzes Brett</a>
      <a onclick="showSection('social-media')">Social Media Werbung</a>
      <a onclick="showSection('profile')">Profil verwalten</a>
      <a onclick="showSection('kontakt')">Kontakt</a>
    </nav>
  </header>

  <div class="container">
    <!-- Login-Simulation -->
    <div id="login-section" class="hidden">
      <h2>Anmelden f√ºr personalisierte Inhalte</h2>
      <form id="login-form">
        <input type="text" id="username" placeholder="Benutzername" required aria-label="Benutzername">
        <input type="password" id="password" placeholder="Passwort" required aria-label="Passwort">
        <button type="button" onclick="simulateLogin()">Anmelden</button>
      </form>
      <p id="login-status"></p>
      <p>DSGVO: Keine Daten√ºbertragung, nur lokale Speicherung.</p>
    </div>

    <!-- Social Media Werbung -->
    <div id="social-media-section" class="hidden">
      <h2>Social Media Werbung (Premium)</h2>
      <p>K√∂nig-Status oder h√∂her: Erstellen Sie Werbung f√ºr Facebook/Twitter!</p>
      <form id="social-media-form">
        <input type="text" id="sm-title" placeholder="Werbetitel (z.B. Pizza Roma Angebot)" required>
        <textarea id="sm-content" placeholder="Werbetext (z.B. 20% Rabatt auf Pizza)" required></textarea>
        <input type="text" id="sm-contact" placeholder="Kontakt (Tel/Email)" required>
        <input type="file" id="sm-image" accept="image/*" aria-label="Werbebild hochladen">
        <button type="button" onclick="postSocialMedia()">Werbung erstellen</button>
      </form>
      <p id="sm-status"></p>
    </div>

    <!-- Profil-Verwaltung -->
    <div id="profile-section" class="hidden">
      <h2>Profil verwalten</h2>
      <p>Anpassen, was Sie sehen wollen/nicht wollen (z.B. Kategorien filtern). DSGVO-konform: Lokale Speicherung.</p>
      <form id="profile-form">
        <label><input type="checkbox" id="show-notdienste" checked> Notdienste anzeigen</label>
        <label><input type="checkbox" id="show-vermisste" checked> Vermisste anzeigen</label>
        <label><input type="checkbox" id="show-kultur" checked> Kultur & Religion anzeigen</label>
        <label><input type="checkbox" id="show-jobs" checked> Jobs & Events anzeigen</label>
        <label><input type="checkbox" id="show-unternehmen" checked> Unternehmen anzeigen</label>
        <label><input type="checkbox" id="show-behoerden" checked> Beh√∂rden & Gerichte anzeigen</label>
        <label><input type="checkbox" id="show-blackboard" checked> Schwarzes Brett anzeigen</label>
        <button type="button" onclick="saveProfilePreferences()">Speichern</button>
      </form>
      <p id="profile-status"></p>
    </div>

    <!-- Grid-Kategorien -->
    <div id="grid-categories" class="grid-categories">
      <div class="grid-button" onclick="showSection('notdienste')"><h3>üö® Notdienste</h3><p>Schnelle Hilfe</p></div>
      <div class="grid-button" onclick="showSection('vermisste')"><h3>üîç Vermisste</h3><p>Gratis Anzeigen</p></div>
      <div class="grid-button" onclick="showSection('kultur-religion')"><h3>üé® Kultur & Religion</h3><p>Vereine & Events</p></div>
      <div class="grid-button" onclick="showSection('jobs-events')"><h3>üíº Jobs & Events</h3><p>Stellen & Veranstaltungen</p></div>
      <div class="grid-button" onclick="showSection('unternehmen')"><h3>üè¢ Unternehmen</h3><p>Businesses & Premium</p></div>
      <div class="grid-button" onclick="showSection('behoerden-gerichte')"><h3>üèõÔ∏è Beh√∂rden</h3><p>Gerichte & √Ñmter</p></div>
      <div class="grid-button" onclick="showSection('blackboard')"><h3>üìå Schwarzes Brett</h3><p>Auftr√§ge & Eink√§ufe</p></div>
      <div class="grid-button" onclick="showSection('gastronomie')"><h3>üçΩÔ∏è Gastronomie</h3><p>Restaurants & Catering</p></div>
      <div class="grid-button" onclick="showSection('handwerker')"><h3>üîß Handwerker</h3><p>Reparaturen</p></div>
    </div>

    <!-- Globale Suche -->
    <input type="text" class="search-bar" placeholder="Suche: Name, Kategorie, Stadt, PLZ..." oninput="renderContent(this.value)" aria-label="Suche">
    <button class="filter-btn" onclick="renderContent('')">Alle</button>
    <button class="filter-btn" onclick="renderContent('Restaurant')">Restaurants</button>
    <button class="filter-btn" onclick="renderContent('Handwerker')">Handwerker</button>
    <button class="filter-btn" onclick="renderContent('Museum')">Museen</button>
    <button class="filter-btn" onclick="renderContent('Beh√∂rde')">Beh√∂rden</button>

    <!-- Sektionen -->
    <div id="region-section" class="hidden">
      <h2 class="category-header">Region w√§hlen</h2>
      <select id="region-select" onchange="filterByRegion(this.value)" aria-label="W√§hle eine Stadt oder Region">
        <option value="">Deutschlandweit</option>
        <option value="Bergheim" selected>Bergheim</option>
        <option value="K√∂ln">K√∂ln</option>
        <option value="D√ºsseldorf">D√ºsseldorf</option>
        <option value="Berlin">Berlin</option>
      </select>
      <input type="text" id="plz-input" placeholder="PLZ eingeben (z.B. 50126)" aria-label="Postleitzahl">
      <button onclick="getUserLocation()" class="cta-button">Standort ermitteln</button>
      <p id="location-status">PLZ eingeben oder Standort teilen.</p>
    </div>

    <div id="notdienste-section" class="hidden">
      <div class="category-header">üö® Notdienste</div>
      <div class="section priority">
        <h3>Apotheken-Notdienst Bergheim</h3>
        <p>Tel: 02271-12345 | Adresse: Hauptstr. 10 | 24/7 | Barrierefrei: Ja</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../apotheke-notdienst-987654.jpg" alt="Apotheke Bergheim">
        <a href="https://wa.me/491631234567" class="cta-button">Premium werden</a>
      </div>
    </div>

    <div id="vermisste-section" class="hidden">
      <div class="category-header">üîç Vermisste Tiere/Menschen (Gratis)</div>
      <div class="section priority">
        <h3>Katze Luna (Bergheim)</h3>
        <p>Seit: 10.08.2025 | Ort: Zentrum | Finderlohn: 50‚Ç¨ | Tel: 0163-1234567</p>
        <img src="https://pixabay.com/get/g9b2b8f4a0.../katze-vermisst-123456.jpg" alt="Vermisste Katze Luna">
        <a href="https://wa.me/491631234567" class="cta-button">Gratis Anzeige posten</a>
      </div>
    </div>

    <div id="kultur-religion-section" class="hidden">
      <div class="category-header">üé® Kultur & Religion</div>
      <div class="section">
        <h3>Kulturverein Bergheim e.V.</h3>
        <p>Event: Stadtfest Bergheim 2025 | Datum: 01.06.2025 | Ort: Zentrum | Barrierefrei: Ja</p>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Bergheim-3571.jpg/800px-Bergheim-3571.jpg" alt="Stadtfest Bergheim">
      </div>
      <div class="section">
        <h3>Museum BERGHEIMAT</h3>
        <p>Geschichte Bergheims | Adresse: Schloss Paffendorf | Barrierefrei: Ja</p>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Bergheim-3571.jpg/800px-Bergheim-3571.jpg" alt="Museum BERGHEIMAT">
      </div>
      <div class="section">
        <h3>RELiGIO Museum Telgte</h3>
        <p>Weltreligionen | Event: F√ºhrungen 2025 | Barrierefrei: Ja</p>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Telgte-RELiGIO-Westf%C3%A4lisches-Museum-f%C3%BCr-religi%C3%B6se-Kultur-2019-01.jpg/800px-Telgte-RELiGIO-Westf%C3%A4lisches-Museum-f%C3%BCr-religi%C3%B6se-Kultur-2019-01.jpg" alt="RELiGIO Museum Telgte">
      </div>
      <div class="section">
        <h3>Event: Eko Fresh Konzert</h3>
        <p>15.11.2025 | MEDIO.RHEIN.ERFT | Tickets via Eventim</p>
        <img src="https://pixabay.com/get/g9b2b8f4a0.../konzert-musik-buehne-153949.jpg" alt="Eko Fresh Konzert">
      </div>
      <a href="https://wa.me/491631234567" class="cta-button">Verein/Event eintragen</a>
    </div>

    <div id="jobs-events-section" class="hidden">
      <div class="category-header">üíº Jobs & Events</div>
      <div class="section">
        <h3>Job: Handwerker (Bergheim)</h3>
        <p>Vollzeit | Bewerbung: WhatsApp 0163-1234567</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../handwerker-arbeit-werkzeug-1234567.jpg" alt="Handwerker Job">
      </div>
      <div class="section">
        <h3>Event: G20 Funk-Flohmarkt</h3>
        <p>17.05.2025 | Bergheim | Barrierefrei: Ja</p>
        <img src="https://pixabay.com/get/gd7c1b4e5f.../flohmarkt-markt-verkauf-1979076.jpg" alt="Flohmarkt Event">
      </div>
      <a href="https://wa.me/491631234567" class="cta-button">Job/Event posten</a>
    </div>

    <div id="unternehmen-section" class="hidden">
      <div class="category-header">üè¢ Unternehmen</div>
      <div class="section priority">
        <h3>Pizza Roma</h3>
        <p>Tel: 02271-12345 | Adresse: Hauptstr. 1 | Status: K√∂nig</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../pizza-restaurant-987654.jpg" alt="Pizza Roma">
        <a href="https://wa.me/491631234567" class="cta-button">Premium werden</a>
      </div>
      <div class="section">
        <h3>Handwerker M√ºller</h3>
        <p>Tel: 02271-34567 | Adresse: Industriestr. 5 | Status: Basis</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../handwerker-werkzeug-1234567.jpg" alt="Handwerker M√ºller">
      </div>
    </div>

    <div id="behoerden-gerichte-section" class="hidden">
      <div class="category-header">üèõÔ∏è Beh√∂rden & Gerichte</div>
      <div class="section">
        <h3>Amtsgericht Bergheim</h3>
        <p>Tel: 02271-56789 | Adresse: Gerichtsstr. 2 | √ñffnungszeiten: Mo-Fr 8-16 Uhr</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../gericht-gebaeude-1234567.jpg" alt="Amtsgericht Bergheim">
      </div>
      <div class="section">
        <h3>Finanzamt Bergheim</h3>
        <p>Tel: 02271-890 | Adresse: Carl-Sonnenschein-Stra√üe 1 | √ñffnungszeiten: Mo-Fr 7:30-12:30 Uhr</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../finanzamt-gebaeude-987654.jpg" alt="Finanzamt Bergheim">
      </div>
      <div class="section">
        <h3>Kreisverwaltung Rhein-Erft-Kreis</h3>
        <p>Tel: 02271-8310 | Adresse: Willy-Brandt-Platz 1 | √ñffnungszeiten: Mo-Fr 8-16 Uhr</p>
        <img src="https://pixabay.com/get/g3f7d8a9b0.../kreisverwaltung-987654.jpg" alt="Kreisverwaltung Rhein-Erft-Kreis">
      </div>
    </div>

    <div id="services-section" class="hidden">
      <div class="category-header">üõ†Ô∏è Andere Services</div>
      <div id="content-list" role="region" aria-live="polite"></div>
    </div>

    <div id="blackboard-section" class="hidden">
      <div class="category-header">üìå Schwarzes Brett</div>
      <p>Posten Sie Auftr√§ge, Eink√§ufe, Catering oder erstellen Sie Rechnungen/Ausschreibungen als PDF.</p>
      <form id="blackboard-form">
        <input type="text" id="bb-title" placeholder="Titel (z.B. Catering f√ºr 50 Personen)" required>
        <textarea id="bb-description" placeholder="Beschreibung" required></textarea>
        <input type="text" id="bb-contact" placeholder="Kontakt (Tel/Email)" required>
        <input type="text" id="bb-invoice" placeholder="Rechnungstext (z.B. Betrag: 500‚Ç¨)" aria-label="Rechnungsdetails">
        <input type="file" id="bb-image" accept="image/*" aria-label="Bild hochladen (optional)">
        <input type="file" id="bb-pdf-file" accept=".pdf" aria-label="PDF hochladen zum √ñffnen">
        <button type="button" onclick="postToBlackboard()">Posten</button>
        <button type="button" onclick="generatePDF()">PDF erstellen</button>
        <button type="button" onclick="openPDFReader()">PDF √∂ffnen/lesen</button>
      </form>
      <div id="pdf-viewer"></div>
      <div id="blackboard-posts"></div>
      <a href="https://wa.me/491631234567" class="cta-button">Premium-Post</a>
    </div>

    <div id="kontakt-section" class="hidden">
      <h2 class="category-header">Kontakt</h2>
      <p>üìû <a href="https://wa.me/491631234567">WhatsApp: 0163-1234567</a> | Email: jblum4564@gmail.com</p>
      <p>Vereine/Beh√∂rden: Gratis! Unternehmen: Premium ab 29‚Ç¨.</p>
      <a class="cta-button" onclick="showSection('social-media')">Social Media Werbung buchen</a>
    </div>

    <!-- Impressum & Datenschutz -->
    <div class="container">
      <h2>Impressum & Datenschutz</h2>
      <p>Joshua Blum | BERGHEIM TOTAL | Hauptstr. 1, 50126 Bergheim | Tel: 0163-1234567 | Steuernummer: [Erg√§nze] | DSGVO-konform, Barrierefrei (WCAG 2.1).</p>
    </div>

    <!-- Copyright -->
    <div class="copyright">
      ¬© 2025 Joshua Blum, BERGHEIM TOTAL. Alle Rechte vorbehalten. Gesch√ºtzt durch Urheberrecht. Marke beim DPMA registriert. Keine Kopie ohne Erlaubnis.
    </div>

    <!-- Cookie-Banner -->
    <div id="cookie-banner" role="alert">
      Wir nutzen Cookies f√ºr Personalisierung (DSGVO-konform). <button onclick="acceptCookies()">OK</button>
    </div>

    <!-- JavaScript -->
    <script>
      // PWA: Service Worker
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(err => console.log('SW Fehler:', err));
      }

      // Daten: Skalierbar, mit Kategorien
      let content = [
        { name: 'Pizza Roma', type: 'Restaurant', region: 'Bergheim', tel: '02271-12345', status: 'K√∂nig', highlight: true, category: 'Unternehmen', image: 'https://pixabay.com/get/g3f7d8a9b0.../pizza-restaurant-987654.jpg' },
        { name: 'Tierheim Bergheim', type: 'Tierheim', region: 'Bergheim', tel: '02271-23456', status: 'Gratis (Sozial)', highlight: false, category: 'Vermisste', image: 'https://pixabay.com/get/g9b2b8f4a0.../tierheim-123456.jpg' },
        { name: 'Kulturverein Bergheim e.V.', type: 'Verein', region: 'Bergheim', description: 'Stadtfest 01.06.2025', status: 'Gratis', highlight: false, category: 'Kultur', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/Bergheim-3571.jpg/800px-Bergheim-3571.jpg' },
        { name: 'RELiGIO Museum', type: 'Museum', region: 'Telgte', description: 'Weltreligionen', status: 'Gratis', highlight: false, category: 'Kultur', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Telgte-RELiGIO-Westf%C3%A4lisches-Museum-f%C3%BCr-religi%C3%B6se-Kultur-2019-01.jpg/800px-Telgte-RELiGIO-Westf%C3%A4lisches-Museum-f%C3%BCr-religi%C3%B6se-Kultur-2019-01.jpg' },
        { name: 'Eko Fresh Konzert', type: 'Event', region: 'Bergheim', description: '15.11.2025, MEDIO.RHEIN.ERFT', status: 'Gratis', highlight: false, category: 'Jobs-Events', image: 'https://pixabay.com/get/g9b2b8f4a0.../konzert-musik-buehne-153949.jpg' },
        { name: 'Amtsgericht Bergheim', type: 'Gericht', region: 'Bergheim', tel: '02271-56789', status: 'Gratis', highlight: false, category: 'Beh√∂rden', image: 'https://pixabay.com/get/g3f7d8a9b0.../gericht-gebaeude-1234567.jpg' },
        { name: 'Finanzamt Bergheim', type: 'Finanzamt', region: 'Bergheim', tel: '02271-890', status: 'Gratis', highlight: false, category: 'Beh√∂rden', image: 'https://pixabay.com/get/g3f7d8a9b0.../finanzamt-gebaeude-987654.jpg' },
        { name: 'Kreisverwaltung Rhein-Erft-Kreis', type: 'Verwaltung', region: 'Bergheim', tel: '02271-8310', status: 'Gratis', highlight: false, category: 'Beh√∂rden', image: 'https://pixabay.com/get/g3f7d8a9b0.../kreisverwaltung-987654.jpg' }
      ];

      // LocalStorage: Backup
      localStorage.setItem('content', JSON.stringify(content));
      content = JSON.parse(localStorage.getItem('content')) || [];

      // Sektionen anzeigen
      function showSection(sectionId) {
        document.querySelectorAll('.container > div').forEach(div => div.classList.add('hidden'));
        document.getElementById(`${sectionId}-section`).classList.remove('hidden');
        document.getElementById('grid-categories').style.display = sectionId === 'region' ? 'grid' : 'none';
      }

      // Render-Funktion
      function renderContent(filter = '', region = '') {
        let list = document.getElementById('content-list');
        list.innerHTML = '';
        const prefs = JSON.parse(localStorage.getItem('profilePreferences')) || {};
        content
          .filter(c => (c.name.toLowerCase().includes(filter.toLowerCase()) || c.type.toLowerCase().includes(filter.toLowerCase()) || c.category?.toLowerCase().includes(filter.toLowerCase())) && (region === '' || c.region === region))
          .filter(c => {
            if (c.category === 'Notdienste' && prefs.showNotdienste === false) return false;
            if (c.category === 'Vermisste' && prefs.showVermisste === false) return false;
            if (c.category === 'Kultur' && prefs.showKultur === false) return false;
            if (c.category === 'Jobs-Events' && prefs.showJobs === false) return false;
            if (c.category === 'Unternehmen' && prefs.showUnternehmen === false) return false;
            if (c.category === 'Beh√∂rden' && prefs.showBehoerden === false) return false;
            return true;
          })
          .forEach(c => {
            let div = document.createElement('div');
            div.className = 'section';
            div.style.background = c.highlight ? '#fffacd' : 'white';
            div.setAttribute('role', 'article');
            div.innerHTML = `<h3>${c.name} (${c.type}, ${c.region})</h3><p>Status: ${c.status} | ${c.tel ? 'Tel: ' + c.tel : c.description || ''}</p>`;
            if (c.image) div.innerHTML += `<img src="${c.image}" alt="${c.name}">`;
            if (c.status.includes('K√∂nig') || c.status.includes('Kaiser') || c.status.includes('Imperator')) {
              div.innerHTML += `<a href="https://wa.me/${c.tel?.replace(/\D/g,'')}" class="cta-button">Kontakt</a>`;
            }
            list.appendChild(div);
          });
      }

      // Region-Filter
      function filterByRegion(region) {
        renderContent(document.querySelector('.search-bar').value, region);
      }

      // Standort-Ermittlung
      function getUserLocation() {
        const plz = document.getElementById('plz-input').value;
        if (plz && /^\d{5}$/.test(plz)) {
          document.getElementById('location-status').textContent = `PLZ erkannt: ${plz}`;
          renderContent('', plz);
        } else if (navigator.geolocation && confirm('Standort teilen f√ºr lokale Ergebnisse? (DSGVO-konform)')) {
          navigator.geolocation.getCurrentPosition(pos => {
            document.getElementById('location-status').textContent = 'Standort erkannt!';
            renderContent('', '', pos.coords.latitude, pos.coords.longitude);
          }, err => {
            document.getElementById('location-status').textContent = 'Fehler: ' + err.message;
          });
        } else {
          document.getElementById('location-status').textContent = 'Bitte PLZ eingeben oder Standort teilen.';
        }
      }

      // Schwarzes Brett
      let blackboardPosts = JSON.parse(localStorage.getItem('blackboardPosts')) || [];
      function postToBlackboard() {
        const title = document.getElementById('bb-title').value;
        const desc = document.getElementById('bb-description').value;
        const contact = document.getElementById('bb-contact').value;
        const image = document.getElementById('bb-image').files[0];
        let imageData = '';
        if (image) {
          const reader = new FileReader();
          reader.onload = e => {
            imageData = e.target.result;
            blackboardPosts.push({ title, desc, contact, image: imageData });
            localStorage.setItem('blackboardPosts', JSON.stringify(blackboardPosts));
            renderBlackboardPosts();
          };
          reader.readAsDataURL(image);
        } else {
          blackboardPosts.push({ title, desc, contact });
          localStorage.setItem('blackboardPosts', JSON.stringify(blackboardPosts));
          renderBlackboardPosts();
        }
      }
      function renderBlackboardPosts() {
        const list = document.getElementById('blackboard-posts');
        list.innerHTML = '';
        blackboardPosts.forEach(post => {
          const div = document.createElement('div');
          div.className = 'section';
          div.innerHTML = `<h3>${post.title}</h3><p>${post.desc}</p><p>Kontakt: ${post.contact}</p>`;
          if (post.image) div.innerHTML += `<img src="${post.image}" alt="${post.title}">`;
          list.appendChild(div);
        });
      }
      renderBlackboardPosts();

      // PDF-Generierung
      function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const title = document.getElementById('bb-title').value || 'Rechnung/Ausschreibung';
        const desc = document.getElementById('bb-description').value || 'Keine Beschreibung';
        const contact = document.getElementById('bb-contact').value || 'Kein Kontakt';
        const invoice = document.getElementById('bb-invoice').value || 'Kein Rechnungstext';
        doc.text('BERGHEIM TOTAL', 10, 10);
        doc.text(`Titel: ${title}`, 10, 20);
        doc.text(`Beschreibung: ${desc}`, 10, 30);
        doc.text(`Kontakt: ${contact}`, 10, 40);
        doc.text(`Rechnung/Ausschreibung: ${invoice}`, 10, 50);
        doc.save(`${title.replace(/\s/g, '_')}.pdf`);
      }

      // PDF-√ñffnen mit pdf.js
      function openPDFReader() {
        const file = document.getElementById('bb-pdf-file').files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = e => {
            pdfjsLib.getDocument(e.target.result).promise.then(pdf => {
              pdf.getPage(1).then(page => {
                const canvas = document.createElement('canvas');
                const viewport = page.getViewport({ scale: 1.5 });
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                page.render({ canvasContext: canvas.getContext('2d'), viewport: viewport });
                document.getElementById('pdf-viewer').innerHTML = '';
                document.getElementById('pdf-viewer').appendChild(canvas);
              });
            });
          };
          reader.readAsArrayBuffer(file);
        } else {
          alert('Laden Sie eine PDF hoch!');
        }
      }

      // Social Media Werbung
      function postSocialMedia() {
        const title = document.getElementById('sm-title').value;
        const content = document.getElementById('sm-content').value;
        const contact = document.getElementById('sm-contact').value;
        const image = document.getElementById('sm-image').files[0];
        if (title && content && contact) {
          document.getElementById('sm-status').textContent = `Werbung vorbereitet: "${title}" wird auf Facebook/Twitter gepostet! Kontakt: 0163-1234567`;
          if (image) {
            const reader = new FileReader();
            reader.onload = e => {
              console.log('Bild f√ºr Social Media:', e.target.result);
            };
            reader.readAsDataURL(image);
          }
        } else {
          document.getElementById('sm-status').textContent = 'Bitte alle Felder ausf√ºllen.';
        }
      }

      // Cookies
      if (!localStorage.getItem('cookies-accepted')) {
        document.getElementById('cookie-banner').style.display = 'block';
      }
      function acceptCookies() {
        localStorage.setItem('cookies-accepted', true);
        document.getElementById('cookie-banner').remove();
      }

      // Login-Simulation
      function simulateLogin() {
        const user = document.getElementById('username').value;
        if (user) {
          localStorage.setItem('user', user);
          document.getElementById('login-status').textContent = 'Angemeldet als ' + user;
        } else {
          document.getElementById('login-status').textContent = 'Fehler bei Anmeldung.';
        }
      }

      // Profil-Verwaltung
      function saveProfilePreferences() {
        const preferences = {
          showNotdienste: document.getElementById('show-notdienste').checked,
          showVermisste: document.getElementById('show-vermisste').checked,
          showKultur: document.getElementById('show-kultur').checked,
          showJobs: document.getElementById('show-jobs').checked,
          showUnternehmen: document.getElementById('show-unternehmen').checked,
          showBehoerden: document.getElementById('show-behoerden').checked,
          showBlackboard: document.getElementById('show-blackboard').checked
        };
        localStorage.setItem('profilePreferences', JSON.stringify(preferences));
        document.getElementById('profile-status').textContent = 'Preferences gespeichert! (DSGVO: Lokale Speicherung)';
        loadProfilePreferences();
      }
      function loadProfilePreferences() {
        const prefs = JSON.parse(localStorage.getItem('profilePreferences')) || {};
        document.getElementById('show-notdienste').checked = prefs.showNotdienste !== false;
        document.getElementById('show-vermisste').checked = prefs.showVermisste !== false;
        document.getElementById('show-kultur').checked = prefs.showKultur !== false;
        document.getElementById('show-jobs').checked = prefs.showJobs !== false;
        document.getElementById('show-unternehmen').checked = prefs.showUnternehmen !== false;
        document.getElementById('show-behoerden').checked = prefs.showBehoerden !== false;
        document.getElementById('show-blackboard').checked = prefs.showBlackboard !== false;
        document.getElementById('notdienste-section').classList.toggle('hidden', !prefs.showNotdienste);
        document.getElementById('vermisste-section').classList.toggle('hidden', !prefs.showVermisste);
        document.getElementById('kultur-religion-section').classList.toggle('hidden', !prefs.showKultur);
        document.getElementById('jobs-events-section').classList.toggle('hidden', !prefs.showJobs);
        document.getElementById('unternehmen-section').classList.toggle('hidden', !prefs.showUnternehmen);
        document.getElementById('behoerden-gerichte-section').classList.toggle('hidden', !prefs.showBehoerden);
        document.getElementById('blackboard-section').classList.toggle('hidden', !prefs.showBlackboard);
      }
      loadProfilePreferences();

      // Initial
      document.getElementById('grid-categories').style.display = 'grid';
      renderContent();
    </script>
  </body>
</html>
